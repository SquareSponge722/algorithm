#include <bits/stdc++.h>
using namespace std;

inline int read(int u = 0, char c = getchar(), bool f = false) {
	for (;!isdigit(c); c = getchar()) f |= c == '-';
	for (; isdigit(c); c = getchar()) u = u * 10 + c - '0';
	return f ? -u : u;
}

int gcd(int a, int b) {
	return b ? gcd(b, a % b) : a;
}

const int maxn = 200;
const int maxm = 25000 + 10;

int a[maxn], b[maxn];

bool del[maxn];

vector<int>G[maxm];
int dis[maxm], tmp[maxm], cnt[maxn];
bool vis[maxm];

struct Node {
	int dis, id, fm;
	Node (int _dis, int _id, int _fm) {
		dis = _dis; id = _id; fm = _fm;
	}
	friend bool operator < (const Node &a, const Node &b) {
		return a.dis > b.dis;
	}
};

priority_queue<Node>pq;

void dijkstra(int A, int n, int id) {
	memset(dis, 0x3f, sizeof(int) * (A + 1));
	memset(vis, 0, sizeof(bool) * (A + 1));		
	
	dis[0] = 0;
	pq.push(Node(0, 0, 0));
	while (pq.size()) {
		int u = pq.top().id, x = pq.top().fm; 
		pq.pop();
		if (del[x]) continue;
		if (vis[u]) continue; vis[u] = true;
		for (int i = 1; i < n; i++) {
			del[i] = true;
			if (a[i] > dis[a[i] % A] * A + a[i] % A) continue;
			if (a[i] == (dis[a[i] % A] * A + i) && cnt[a[i] % A] > 1) continue;
			del[i] = false;
			int v = (u + a[i]) % A, w = dis[u] + (u + a[i]) / A;
			if (dis[v] > w) {
				dis[v] = w; cnt[v] = 1;
				pq.push(Node(dis[v], v, u));
			} else if (dis[v] == w) {
				cnt[v]++;
			}
		}
	}
}

bool cmp(int *A, int *B, int n) {
	for (int i = 0; i < n; i++)
		if (A[i] != B[i]) return false;
	return true;
}

int deal(int n) {
	sort(a, a + n);
	int A = a[0];
	memset(del, 0, sizeof del);
	memset(cnt, 0, sizeof cnt);
	//cout << "GG" << endl;
	dijkstra(A, n, -1);
	
	for (int i = 0; i < n; i++) cout << a[i] << ' '; cout << endl;
	for (int i = 0; i < A; i++) cout << dis[i] << ' '; cout << endl;
	for (int i = 0; i < A; i++) cout << cnt[i] << ' '; cout << endl;
	
	int ans = 1;
	
	cout << a[0] << ' ';
	
	for (int i = 1; i < n; i++) {
		if (a[i] > dis[a[i] % A] * A + a[i] % A) continue;
		if (a[i] == (dis[a[i] % A] * A + i) && cnt[a[i] % A] > 1) continue;
		ans++;
		cout << a[i] << ' ';
	}
	cout << endl;
	return ans;
}

void work() {
	memset(del, 0, sizeof del);
	int n = read(), _gcd = 0;
	for (int i = 0; i < n; i++) a[i] = read();
	for (int i = 0; i < n; i++) _gcd = gcd(a[i], _gcd);
	for (int i = 0; i < n; i++) a[i] /= _gcd;
	for (int i = 0; i < n; i++) if (!del[i]) {
		for (int j = i + 1; j < n; j++) if (!del[j]) {
			if (a[i] == a[j]) del[j] = true;
			else {
				if (a[i] % a[j] == 0) {
					del[i] = true;
				}
				if (a[j] % a[i] == 0) {
					del[j] = true;
				}
			}
		}
	}
	b[0] = 0;
	for (int i = 0; i < n; i++) if (!del[i]) b[++b[0]] = a[i];
	n = b[0];
	for (int i = 0; i < n; i++) a[i] = b[i + 1];
	cout << deal(n) << endl;
	//cout << deal2(n) << endl;
}

int main() {
	//freopen("money2.in", "r", stdin);
	//freopen("money.out", "w", stdout);

	int T = read();
	while (T--) work();
	return 0;
} 
